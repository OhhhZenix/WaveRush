name: Build
jobs:
  job:
    name: ${{ matrix.os }}-${{ matrix.build-type }}
    runs-on: ${{matrix.os}}
    strategy:
      fail-fast: false
      matrix:
        build-type: [ Debug, Release ]
        os: [ ubuntu-latest, macos-latest, windows-latest ]
    steps:
    - uses: ilammy/setup-nasm@v1
    - uses: actions/checkout@v3

    - name: Install dependencies (Ubuntu)
      if: matrix.os == 'ubuntu-latest'
      run: |
        sudo apt-get update
        sudo apt-get install -y libasound2-dev libx11-dev libxrandr-dev \
        libxi-dev libgl1-mesa-dev libglu1-mesa-dev libxcursor-dev \
        libxinerama-dev libwayland-dev libxkbcommon-dev

    - name: Create Build Environment
      run: cmake -E make_directory ${{github.workspace}}/build

    - name: Configure CMake
      shell: bash
      working-directory: ${{github.workspace}}/build
      run: cmake $GITHUB_WORKSPACE -DCMAKE_BUILD_TYPE=${{ matrix.build-type }}

    - name: Build
      working-directory: ${{github.workspace}}/build
      shell: bash
      run: cmake --build . --config ${{ matrix.build-type }}
on: [ push ]
